function ie(){import.meta.url,import("_").catch(()=>1);async function*n(){}}const{contentDisplaySettings:f}=acfwfBlocksi18n,k=n=>{const{onChange:e,settings:c}=n,{discount_value:t,description:r,usage_limit:l,schedule:p,expired_coupons:o}=c;return React.createElement(React.Fragment,null,React.createElement(wp.components.ToggleControl,{label:f.displayDiscountValue,checked:t,onChange:()=>e({...c,discount_value:!t})}),React.createElement(wp.components.ToggleControl,{label:f.displayDescription,checked:r,onChange:()=>e({...c,description:!r})}),React.createElement(wp.components.ToggleControl,{label:f.displayUsageLimit,checked:l,onChange:()=>e({...c,usage_limit:!l})}),React.createElement(wp.components.ToggleControl,{label:f.displaySchedule,checked:p,onChange:()=>e({...c,schedule:!p})}),React.createElement(wp.components.ToggleControl,{label:f.hideExpiredCoupons,checked:o,onChange:()=>e({...c,expired_coupons:!o})}))},{searchAndSelectCouponLabel:D}=acfwfBlocksi18n,I=n=>{const{coupon_id:e,setAttributes:c}=n,[t,r]=wp.element.useState([]),[l,p]=wp.element.useState(""),[o,u]=wp.element.useState(null),[s,a]=wp.element.useState(!1),[b,v]=wp.element.useState(!1),F=m=>{v(!1),o&&(clearTimeout(o),u(null)),m||a(!1),!(m.length<3)&&(s||a(!0),u(setTimeout(async()=>{try{l&&l!==m&&r([]);const d=await wp.apiFetch({path:"/wc/v3/coupons/?search=".concat(m)});d.length?r(d.map(C=>({value:C.id,label:C.code}))):v(!0),a(!1)}catch(d){console.log(d)}},1e3)))},P=m=>{const d=t.findIndex(C=>C.value===m);0<=d&&c({coupon_id:m,coupon_code:t[d].label})};return React.createElement("div",{className:"acfw-coupon-search-field-wrap"},React.createElement(wp.components.ComboboxControl,{label:D,value:e,onChange:P,options:t,onFilterValueChange:F}),s&&React.createElement(wp.components.Spinner,null),b&&React.createElement("div",null,acfwfBlocksi18n.emptyCouponSearch))},{singleCouponTexts:g,contentDisplaySettings:V,currentlySelectedCouponLabel:L,doneBtnText:A}=acfwfBlocksi18n,M=n=>{const{attributes:e,name:c,setAttributes:t}=n,[r,l]=wp.element.useState(1>e.coupon_id);return React.createElement(React.Fragment,null,React.createElement(wp.blockEditor.BlockControls,null,React.createElement(wp.components.ToolbarGroup,{controls:[{icon:"edit",title:"Edit",onClick:()=>l(!r),isActive:r}]})),React.createElement(wp.blockEditor.InspectorControls,{key:"inspector"},React.createElement(wp.components.PanelBody,{title:V.title,initialOpen:!0},React.createElement(k,{settings:e.contentVisibility,onChange:p=>t({contentVisibility:p})}))),r?React.createElement(wp.components.Placeholder,{label:g.title,className:"acfw-block-single-coupon"},g.description,React.createElement("div",{className:"acfw-single-block-fields"},e.coupon_code!==""&&React.createElement("div",{className:"acfw-block-current-coupon-selected"},React.createElement("span",null,L),React.createElement("span",{className:"coupon-code",title:e.coupon_code},e.coupon_code)),React.createElement("div",{className:"acfw-block-coupon__selection"},React.createElement(I,{coupon_id:e.coupon_id,setAttributes:t}))),React.createElement("div",{className:"acfw-block-action-buttons"},React.createElement(wp.components.Button,{isPrimary:!0,onClick:()=>l(!1)},A))):React.createElement(React.Fragment,null,0<e.coupon_id?React.createElement(wp.serverSideRender,{block:c,attributes:e,EmptyResponsePlaceholder:()=>React.createElement(wp.components.Placeholder,{label:g.title,className:"acfw-block-single-coupon"},g.emptyDesc)}):React.createElement(wp.components.Placeholder,{label:g.title,className:"acfw-block-coupons-grid acfw-block-coupons-category"},React.createElement("p",null,g.selectDesc))))},O=wp.components.withSpokenMessages(M),{orderTypeFieldTexts:y}=acfwfBlocksi18n,i={minColumns:1,maxColumns:6,minCount:1,maxCount:100},N=[{value:"date/desc",label:y.options.newestToOldest},{value:"date/asc",label:y.options.oldestToNewest},{value:"title/asc",label:y.options.aToZ},{value:"title/desc",label:y.options.zToA},{value:"expire/asc",label:y.options.earliestToExpire}],$={order_by:{type:"string",default:"date/desc"},columns:{type:"number",default:3},count:{type:"number",default:10}},_={contentVisibility:{type:"object",default:{discount_value:!0,description:!0,usage_limit:!0,schedule:!0,expired_coupons:!0}},isPreview:{type:"boolean",default:!1}};const{singleCouponTexts:x}=acfwfBlocksi18n,G={name:"acfw/single-coupon",settings:{title:x.title,icon:"tickets-alt",category:"advancedcoupons",keywords:["coupon","advanced"],decription:x.description,supports:{align:["wide","full"],html:!1},example:{attributes:{isPreview:!0}},attributes:{coupon_id:{type:"number",default:0},coupon_code:{type:"string",default:""},..._},edit(n){return React.createElement(O,{...n})},save(){return null}}};function H(){const n=wp.element.useRef(!0),e=wp.element.useCallback(()=>n.current,[]);return wp.element.useEffect(()=>()=>void(n.current=!1),[]),e}const{couponsCategoryTexts:U}=acfwfBlocksi18n,j=n=>{const{categories:e,setCategories:c,selected:t,onChange:r}=n,l=H();wp.element.useEffect(()=>{0<e.length||wp.apiFetch({path:"/wp/v2/shop_coupon_cat?per_page=-1&order=desc&orderby=count"}).then(o=>{l&&c(o)})},[]);const p=(o,u)=>{r(o?[...t,u.id]:t.filter(s=>s!==u.id))};return React.createElement("div",{className:"acfw-coupon-categories"},React.createElement("div",{className:"acfw-coupon-categories__label"},U.selectCategories),React.createElement("div",{className:"acfw-coupon-categories__list"},e.length?React.createElement(React.Fragment,null,e.map(o=>React.createElement("div",{className:"acfw-coupon-categories__item",key:o.id},React.createElement(wp.components.CheckboxControl,{label:"".concat(o.name," (").concat(o.count,")"),checked:t.includes(o.id),onChange:u=>p(u,o)})))):React.createElement("div",{className:"acfw-coupon-categories__spinner"},React.createElement(wp.components.Spinner,null))))},{couponsCategoryTexts:w,orderTypeFieldTexts:z,numberofItemsFieldLabel:Z,numberofColumnsFieldLabel:q,contentDisplaySettings:J,doneBtnText:K}=acfwfBlocksi18n,Q=n=>{const{attributes:e,name:c,setAttributes:t,debouncedSpeak:r}=n,[l,p]=wp.element.useState(1>e.categories.length),[o,u]=wp.element.useState([]),s=e.categories.length>0;return React.createElement(React.Fragment,null,React.createElement(wp.blockEditor.BlockControls,null,React.createElement(wp.components.ToolbarGroup,{controls:[{icon:"edit",title:"Edit",onClick:()=>p(!l),isActive:l}]})),React.createElement(wp.blockEditor.InspectorControls,{key:"inspector"},React.createElement(wp.components.PanelBody,{title:J.title,initialOpen:!0},React.createElement(k,{settings:e.contentVisibility,onChange:a=>t({contentVisibility:a})}))),l?React.createElement(wp.components.Placeholder,{label:w.title,className:"acfw-block-coupons-grid acfw-block-coupons-category"},w.description,React.createElement("div",{className:"wc-block-coupon-category__selection fullwidth-field"},React.createElement(j,{categories:o,setCategories:u,selected:e.categories,onChange:(a=[])=>{t({categories:a})}})),React.createElement("div",{className:"order-by__selection one-third-col"},React.createElement(wp.components.SelectControl,{label:z.label,value:e.order_by,options:N,onChange:a=>t({order_by:a})})),React.createElement("div",{className:"items-count__range one-third-col"},React.createElement(wp.components.RangeControl,{label:Z,value:e.count,onChange:a=>{const b=window.lodash.clamp(a,i.minCount,i.maxCount);t({count:b})},min:i.minCount,max:i.maxCount})),React.createElement("div",{className:"column-count__range one-third-col"},React.createElement(wp.components.RangeControl,{label:q,value:e.columns,onChange:a=>{const b=window.lodash.clamp(a,i.minColumns,i.maxColumns);t({columns:b})},min:i.minColumns,max:i.maxColumns})),React.createElement(wp.components.Button,{isPrimary:!0,onClick:()=>p(!1)},K)):React.createElement(React.Fragment,null,s?React.createElement(wp.serverSideRender,{block:c,attributes:e,EmptyResponsePlaceholder:()=>React.createElement(wp.components.Placeholder,{label:w.title,className:"acfw-block-coupons-grid acfw-block-coupons-category"},w.emptyDesc)}):React.createElement(wp.components.Placeholder,{label:w.title,className:"acfw-block-coupons-grid acfw-block-coupons-category"},React.createElement("p",null,w.selectDesc))))},W=wp.components.withSpokenMessages(Q);const{couponsCategoryTexts:T}=acfwfBlocksi18n,X={name:"acfw/coupons-category",settings:{title:T.title,icon:"tickets-alt",category:"advancedcoupons",keywords:["coupon","advanced","category"],decription:T.description,supports:{align:["wide","full"],html:!1},example:{attributes:{isPreview:!0}},attributes:{categories:{type:"array",default:[]},...$,..._},edit(n){return React.createElement(W,{...n})},save(){return null}}},{isPremium:h,couponsCustomerTexts:E,displayTypeFieldTexts:R,orderTypeFieldTexts:Y,numberofItemsFieldLabel:ee,numberofColumnsFieldLabel:te,contentDisplaySettings:ne,premiumUpsellMessage:S,doneBtnText:oe}=acfwfBlocksi18n,ce=n=>{const{attributes:e,name:c,setAttributes:t,debouncedSpeak:r}=n,[l,p]=wp.element.useState(e.display_type===""),o=[{value:"both",label:R.options.couponsAndVirtualCoupons},{value:"coupons_only",label:R.options.couponsOnly},{value:"virtual_only",label:R.options.virtualCouponsOnly}],u=()=>{e.display_type===""&&t({display_type:"both"}),p(!1)};return React.createElement(React.Fragment,null,React.createElement(wp.blockEditor.BlockControls,null,React.createElement(wp.components.ToolbarGroup,{controls:[{icon:"edit",title:"Edit",onClick:()=>p(!l),isActive:l}]})),React.createElement(wp.blockEditor.InspectorControls,{key:"inspector"},React.createElement(wp.components.PanelBody,{title:ne.title,initialOpen:!0},React.createElement(k,{settings:e.contentVisibility,onChange:s=>t({contentVisibility:s})}))),l?React.createElement(wp.components.Placeholder,{label:E.title,className:"acfw-block-coupons-grid acfw-block-coupons-customer ".concat(h?"":"acfw-disabled-upsell")},React.createElement("div",{className:"description fullwidth-field"},E.description),React.createElement("div",{className:"display-type__selection one-half-col"},React.createElement(wp.components.SelectControl,{label:R.label,value:e.display_type,options:o,onChange:s=>t({display_type:s})})),React.createElement("div",{className:"order-by__selection one-half-col"},React.createElement(wp.components.SelectControl,{label:Y.label,value:e.order_by,options:N,onChange:s=>t({order_by:s})})),React.createElement("div",{className:"items-count__range one-third-col"},React.createElement(wp.components.RangeControl,{label:ee,value:e.count,onChange:s=>{const a=window.lodash.clamp(s,i.minCount,i.maxCount);t({count:a})},min:i.minCount,max:i.maxCount})),React.createElement("div",{className:"column-count__range one-third-col"},React.createElement(wp.components.RangeControl,{label:te,value:e.columns,onChange:s=>{const a=window.lodash.clamp(s,i.minColumns,i.maxColumns);t({columns:a})},min:i.minColumns,max:i.maxColumns})),React.createElement("div",{className:"block-actions fullwidth-field"},React.createElement(wp.components.Button,{isPrimary:!0,onClick:u},oe)),!h&&React.createElement("div",{className:"acfw-upsell-message",dangerouslySetInnerHTML:{__html:S}})):React.createElement(wp.serverSideRender,{block:c,attributes:e,EmptyResponsePlaceholder:()=>React.createElement(wp.components.Placeholder,{label:E.title,className:"acfw-block-coupons-grid acfw-block-coupons-customer"},E.emptyDesc,!h&&React.createElement("div",{className:"acfw-upsell-message",dangerouslySetInnerHTML:{__html:S}}))}))},le=wp.components.withSpokenMessages(ce);const{couponsCustomerTexts:B}=acfwfBlocksi18n,ae={name:"acfw/coupons-customer",settings:{title:B.title,icon:"tickets-alt",category:"advancedcoupons",keywords:["coupon","advanced","customer","user"],decription:B.title,supports:{align:["wide","full"],html:!1},example:{attributes:{isPreview:!0}},attributes:{display_type:{type:"string",default:""},...$,..._},edit(n){return React.createElement(le,{...n})},save(){return null}}};const se=n=>{if(!n)return;const{name:e,settings:c}=n;wp.blocks.registerBlockType(e,c)};wp.domReady(()=>{[G,X,ae].forEach(se)});export{ie as __vite_legacy_guard};
